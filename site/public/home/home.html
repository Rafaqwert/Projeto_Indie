<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="../css/home_style.css">
    <link rel="icon" type="image/x-icon" href="../assets/icons/world.ico">
</head>

<body>
    <!--Windows XP-->
    <section class="section_xp">
        <div class="div_windowXp">
            <!--Header-->
            <header class="header_xp">
                <div class="div_header">
                    <div class="div_headerTop">
                        <img src="../assets/icons/maquina.ico">
                        <p>Windows XP</p>
                    </div>
                </div>

                <div class="div_headerBot">
                    <ul>
                        <li><a href="">
                                <p><u>C</u>onta</p>
                            </a></li>
                        <li><a href="#div_home">
                                <p><u>Í</u>nicio</p>
                            </a></li>
                        <li><a href="">
                                <p><u>T</u>ópicos</p>
                            </a></li>
                        <li><a href="">
                                <p><u>V</u>otação</p>
                            </a></li>
                        <li><a href="">
                                <p><u>C</u>omentários</p>
                            </a></li>
                    </ul>
            </header>
            <!--Fim header-->

            <!--Social-->
            <div class="div_home" id="div_home">
                <div class="div_cape">
                    <h1>Bem-vindo <span id="span_user"></span></h1>
                </div>
                <div class="div_content">
                    <article>
                        <p>
                            Lorem ipsum dolor, sit amet consectetur
                            adipisicing elit. Beatae officiis aperiam
                            in incidunt nisi saepe, temporibus quam
                            cupiditate eos ab voluptates, consectetur
                            sequi modi excepturi? Laborum inventore fuga
                            reprehenderit sequi.
                        </p>
                        <p>
                            Lorem ipsum dolor sit amet,
                            consectetur adipisicing elit.
                            Labore amet nihil nobis ullam impedit
                            aliquam voluptate maxime error laboriosam molestias?
                            Sunt unde soluta nemo voluptas ipsam
                            dignissimos nesciunt laboriosam consequuntur?
                        </p>
                    </article>
                    <div class="div_agent">
                        <img src="../assets/imgs/picmix.com_1936729.png">
                    </div>
                </div>
            </div>

            <div class="div_home2">
                <div class="div_contentContainer">
                    <div class="img">
                        <img src="../assets/imgs/y2k.jpg">
                    </div>
                    <div class="div_content">
                        <article>
                            <h1>Lorem ipsum</h1>
                            <p>
                                Lorem ipsum dolor, sit amet consectetur
                                adipisicing elit. Beatae officiis aperiam
                                in incidunt nisi saepe, temporibus quam
                                cupiditate eos ab voluptates, consectetur
                                sequi modi excepturi? Laborum inventore fuga
                                reprehenderit sequi.
                            </p>
                            <p>
                                Lorem ipsum dolor, sit amet consectetur
                                adipisicing elit. Beatae officiis aperiam
                                in incidunt nisi saepe, temporibus quam
                                cupiditate eos ab voluptates, consectetur
                                sequi modi excepturi? Laborum inventore fuga
                                reprehenderit sequi.
                            </p>
                        </article>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Windows 95 -->
    <Section class="section_95">
        <div class="div_window95">
            <!--Header-->
            <header class="header_95">
                <div class="div_header">
                    <div class="div_headerTop">
                        <img src="../assets/icons/maquinario.ico">
                        <p>Windows 95</p>
                    </div>
                </div>

                <div class="div_headerBot">
                    <ul>
                        <li><a href="">
                                <p><u>C</u>onta</p>
                            </a></li>
                        <li><a href="#div_home">
                                <p><u>Í</u>nicio</p>
                            </a></li>
                        <li><a href="">
                                <p><u>T</u>ópicos</p>
                            </a></li>
                        <li><a href="">
                                <p><u>V</u>otação</p>
                            </a></li>
                        <li><a href="">
                                <p><u>C</u>omentários</p>
                            </a></li>
                    </ul>
                </div>
            </header>
            <!-- Fim header -->
            <!-- Social -->
            <div class="div_home">
                <div class="div_content">
                    <img src="../assets/gifs/baby.gif">
                </div>
            </div>
            <div class="div_home2">
                <div class="div_content">
                    <div class="div_section">
                        <article>
                            <p>
                                Lorem, ipsum dolor sit amet consectetur adipisicing elit. Facere fugit quibusdam eum
                                pariatur vitae laudantium sequi dignissimos sunt repellat. Eos rem non numquam facere
                                repudiandae labore illum magni harum saepe?
                            </p>
                        </article>

                        <div class="div_decor">
                            <div class="div_miniwindow">
                                <div class="div_miniheader">
                                    <img src="../assets/icons/explorer.ico">
                                    <p>Internet</p>
                                </div>
                                <div class="div_minihome">
                                    <img src="../assets/gifs/vapor_road.gif" class="road">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="div_section">
                        <div class="div_decor">
                            <div class="div_miniwindow">
                                <div class="div_miniheader">
                                    <img src="../assets/icons/explorer.ico">
                                    <p>Vaporman</p>
                                </div>
                                <div class="div_minihome">
                                    <!-- <img src="../assets/imgs/vapor_bg.jpg" class="vapor_bg"> -->
                                    <div class="div_vapor">
                                        <img src="../assets/imgs/vapor_memo.png">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <article>
                            Lorem, ipsum dolor sit amet consectetur adipisicing elit. Facere fugit quibusdam eum
                            pariatur vitae laudantium sequi dignissimos sunt repellat. Eos rem non numquam facere
                            repudiandae labore illum magni harum saepe?
                        </article>
                    </div>
                </div>
            </div>
        </div>
    </Section>

    <!-- Windows 7 -->
    <section class="section_7">
        <div class="div_window7">
            <!--Header-->
            <header class="header_7">
                <div class="div_header">
                    <div class="div_headerTop">
                        <img src="../assets/icons/computador.ico">
                        <p>Windows 7</p>
                    </div>

                    <div class="div_headerBot">
                        <ul>
                            <li><a href="">
                                    <p>Conta</p>
                                </a></li>
                            <li><a href="#div_home">
                                    <p>Ínicio</p>
                                </a></li>
                            <li><a href="">
                                    <p>Tópicos</p>
                                </a></li>
                            <li><a href="">
                                    <p>Votação</p>
                                </a></li>
                            <li><a href="">
                                    <p>Comentários</p>
                                </a></li>
                        </ul>
                    </div>
                </div>
            </header>
            <!--Fim header-->

            <!-- Social -->
            <div class="div_home">
                <div class="div_content">
                    <article>
                        Lorem ipsum dolor sit amet consectetur
                        adipisicing elit. Provident voluptate, sint
                        quae a molestias esse quidem excepturi possimus.
                        Expedita libero earum asperiores voluptatibus
                        alias voluptatem tempore, repellendus excepturi
                        similique obcaecati.
                    </article>

                    <div class="img">
                        <img src="../assets/imgs/fa_bg.jpg">
                    </div>
                </div>
            </div>

            <div class="div_quiz">
                <div class="div_questions">
                    <fieldset class="radios">
                        <legend>Escolha sua estética favorita</legend>

                        <input type="radio" id="slct_none" name="option" onclick="favoritar(1)">
                        <label for="slct_none">(Não selecionar)</label><br>

                        <input type="radio" id="slct_oldWeb" name="option" onclick="favoritar(2)">
                        <label for="slct_oldWeb">Old web</label><br>

                        <input type="radio" id="slct_y2k" name="option" onclick="favoritar(3)">
                        <label for="slct_y2k">Y2K</label><br>

                        <input type="radio" id="slct_frutAero" name="option" onclick="favoritar(4)">
                        <label for="slct_frutAero">Frutiger Aero</label><br>

                        <input type="radio" id="slct_vaporwave" name="option" onclick="favoritar(5)">
                        <label for="slct_vaporwave">Vaporwave</label><br>
                    </fieldset>
                </div>
                <div class="div_graphic">
                    <canvas id="myChart"></canvas>
                </div>
            </div>

        </div>
    </section>
</body>

</html>

<script>

    span_user.innerHTML = sessionStorage.NOME_USUARIO;

    let proximaAtualizacao;

    window.onload = obterDadosGrafico();

    function obterDadosGraficos() {
        obterDadosGraficos(1)
        obterDadosGraficos(2)
        obterDadosGraficos(3)
        obterDadosGraficos(4)
    }


    // const ctx = document.getElementById('myChart');

    // new Chart(ctx, {
    //     type: 'pie',
    //     data: {
    //         labels: ['Old web', 'Y2K', 'Frutiger aero', 'Vaporwave'],
    //         datasets: [{
    //             label: 'Popularidade da estética',
    //             data: [],
    //             borderWidth: 1
    //         }]
    //     }
    // });

    function favoritar(fav) {

        var idCadastro = sessionStorage.ID_USUARIO;
        var favorito = fav;

        console.log("Seu favorito:", favorito)
        console.log("Seu id é:,", idCadastro)

        fetch("/usuarios/favoritar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                idServer: idCadastro,
                favServer: favorito
            })
        })
        return false;
    }

    function obterDadosGrafico(idFavorito) {


        fetch(`/medidas/ultimas`, {cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                    resposta.reverse();

                    plotarGrafico(resposta);

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        }).catch(function (error) {
            console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
        });
    }


    function plotarGrafico(resposta) {

        console.log('iniciando plotagem do gráfico...');

        let labels = [];

        let dados = {
            //dados Old web
            labels: labels,
            datasets: [{
                label: 'Old web',
                data: [],
                borderWidth: 1
            },
            {
            //dados Y2K
                label: 'Y2K',
                data: [],
                borderWidth: 1
            },
            {
            //dados Frutiger aero
                label: 'Frutiger aero',
                data: [],
                borderWidth: 1
            },
            {
            //dados Vaporwave
                label: 'Vaporwave',
                data: [],
                borderWidth: 1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            labels.push();
            dados.datasets[0].data.push(registro.Old_Web);
            dados.datasets[1].data.push(registro.Y2K_Millenium);
            dados.datasets[2].data.push(registro.Frutiger_Aero);
            dados.datasets[3].data.push(registro.Vaporwave);
        }

        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        const config = {
            type: 'pie',
            data: dados,
        };

        let myChart = new Chart(
            ducument.getElementById(`myChart`),
            config
        );
        // setTimeout(() => atualizarGrafico(dados, myChart), 2000);
    }

    function atualizarGrafico() {

    }
</script>